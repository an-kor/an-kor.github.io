var Messages={loadingDeals:"Laddar deals...",searchDeal:"Sök deals",myDeals:"Mina deals",changeCity:"Ändra stad",selectCity:"Välj stad",settings:"Inställningar",hours:"tim",minutes:"min",seconds:"sek",left:"kvar",countdownInfo:"En deal avslutas när klockan räknat ned till noll under förutsättning att den inte blir slutsåld. Populära deals kan komma att förlängas så att fler får möjligheten att köpa dealen. För mer information, se våra allmänna villkor.",backBtn:"Fler deals",share:"Dela",shareWithFriends:"Tipsa om dealen",
cancel:"Avbryt",buy:"Köp",buyAction:"Köp av",bought:"köpta",kr:"kr",highlights:"Höjdpunkter",terms:"Villkor",about:"Om dealen",other:"Övrigt",seller:"Dealen säljes av",searchPlaceholder:"Sök deals",myDealsSrc:"http://letsdeal.se/?mydealsmob",buySrc:"http://www.letsdeal.se/?mobilebuy&deal=%DEAL_ID%&device=app&email=&udid=",seeAllCategories:"Välj kategori",noResults:"Inga sökträffar",noResultsDescription:"Ordet <strong class='search-noresults-keyword'></strong> gav ingen träff, vänligen försök med ett annat sökdord.",
searchCategories:"Eller välj kategori:",shareTitle:"Din vän har tipsat om en bra deal!",shareText:"Spana in dagens deal på Letsdeal.se! %NAME%",shareFacebookText:"Spana in dealen på Letsdeal.se!",shareTextWithLink:"Hej, \r\nSpana in dagens deal på Letsdeal.se! \r\n%NAME% \r\nMer info hittar du här:%LINK%",viaTwitter:"Letsdeal_sve",noConnectionTitle:"<strong>Kunde inte ladda deals!</strong><br/>Vänligen kontrollera er internetuppkoppling",noConnectionMsg:"Försök igen",instructionsTitle:"Så gör du",
instructionsHorizontal:"Svajpa åt sidan för att välja avdelning",instructionsVertical:"Svajpa nedåt för att se fler deals",soldOut:"Slutsåld",viewAll:"Visa alla",restOfCountry:"Övriga landet",facebookAppId:0x640038cce083};var T={isIOS:/iP(ad|hone|od)/.test(navigator.userAgent),isIPad:/iPad/.test(navigator.userAgent),isWebkit:/WebKit/.test(navigator.userAgent),isDesktop:!("ontouchstart"in document.documentElement),isChrome:/Chrome/.test(navigator.userAgent),isAndroid:/Android/.test(navigator.userAgent),isAndroid2:/Android 2/.test(navigator.userAgent),isStandalone:!1,getIOSVersion:function(){var a=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return[parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3]||0,10)]},checkStandalone:function(){this.isIOS&&
7<=this.getIOSVersion()[0]&&(navigator.isStandalone?T.isStandalone=!0:/safari/i.test(navigator.userAgent)||(T.isStandalone=!0))},scale:1,byId:function(a){return document.getElementById(a)},remove:function(a){a=T.byId(a);a.parentElement.removeChild(a)},query:function(a,b){var c=document.querySelectorAll(a);return(1==c.length||b)&&!1!==b?c[0]:c},each:function(a,b){var c=0;if(null!=a){if(!a.length)return b(a);for(;c<a.length;)b(a[c]),c++;return!0}},w:function(){return window.innerWidth},h:function(){if(T.isAndroid){var a=
screen.availHeight;90==Math.abs(window.orientation)&&(a=screen.availWidth);return window.innerHeight>0.6*(a/window.devicePixelRatio)?window.innerHeight:(a-window.screenTop)/window.devicePixelRatio}return T.isStandalone?window.innerHeight-20:window.innerHeight},p:function(a,b){return b?Math.ceil(this.scale*a):parseFloat((this.scale*a).toFixed(3))},px:function(){return this.p.apply(this,arguments)+"px"},setW:function(a,b){T.byId(a).style.width=b+"px"},setH:function(a,b){T.byId(a).style.height=b+"px"},
inArray:function(a,b,c){var d=!1,e;for(e in b)if(c&&b[e][c]==a||!c&&b[e]==a){d=e;break}return d},updateStyle:function(a,b,c){var d=document.styleSheets[1].cssRules,e;for(e in d)if(d[e].selectorText&&d[e].selectorText==a){if("undefined"!=typeof c)d[e].style[b]=c;else for(var f in b)d[e].style[f]=b[f];break}},url:"./controller.php",request:function(a,b,c,d,e){e||(e=2E4);c?c.action=a:c={action:a};c.apikey="a4Gsm";T.xhrReq({url:T.url,dataType:"text",type:"POST",timeout:e,data:c,success:function(a){try{b(JSON.parse(a))}catch(c){console.error("error on parsing data",
a),console.error(c),d()}},error:function(a){App.showNoConnection();d(a)}})},formatNumber:function(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")},initHover:function(a,b,c,d){a.length||(a=[a]);c||(c=null);for(var e=0;e<a.length;e++)a[e].addEventListener("touchstart",function(){d?this.style.background=b:this.style.backgroundColor=b}),a[e].addEventListener("touchend",function(){this.style.backgroundColor=c})},preloadImages:function(){var a="img/broken_tag.png img/loadinfo-blue.gif img/clock.png img/loadinfo.gif img/share-btn.png img/gesture-h.png img/gesture-v.png img/logo-small.png img/back-btn.png".split(" "),
b;for(b in a)try{(new Image).src=a[b]}catch(c){}},getDistance:function(a,b){b.Lat=parseFloat(b[0]);b.Lon=parseFloat(b[1]);a.Lat=parseFloat(a[0]);a.Lon=parseFloat(a[1]);this.R=6378.137;this.d2r=Math.PI/180;this.dLat=(b.Lat-a.Lat)*this.d2r;this.dLon=(b.Lon-a.Lon)*this.d2r;this.lat1=a.Lat*this.d2r;this.lat2=b.Lat*this.d2r;this.sin1=Math.sin(this.dLat/2);this.sin2=Math.sin(this.dLon/2);this.a=this.sin1*this.sin1+this.sin2*this.sin2*Math.cos(this.lat1)*Math.cos(this.lat2);return this.d=2*this.R*Math.atan2(Math.sqrt(this.a),
Math.sqrt(1-this.a))},stopScrolling:function(a){clearInterval(App.scrollInterval);App.scrollInterval=0;App.isScrolling=0;App.scrollCounter=0;T.byId("footer").innerHTML="not scrolling"},checkScrolling:function(a,b){if(!App.isScrolling&&(10<Math.abs(a.touches[0].pageX-App.scrollStartEvent.x)||10<Math.abs(a.touches[0].pageY-App.scrollStartEvent.y)))App.isScrolling=1,App.currentTop=b.scrollTop,App.scrollCounter=0,App.scrollInterval||(App.scrollInterval=setInterval(function(){T.byId("footer").innerHTML=
"scrolling"+b.scrollTop+" "+App.currentTop+" "+App.scrollCounter;10>Math.abs(b.scrollTop-App.currentTop)&&App.scrollCounter++;3<App.scrollCounter&&b.scrollTop!=App.currentTop||10<App.scrollCounter?T.stopScrolling(b):App.currentTop=b.scrollTop},250))},getCountdownTime:function(a){a=parseInt(a,10);var b=Math.floor((new Date).getTime()/1E3);a-=b;var b=Math.floor(a/3600),c=Math.floor((a-3600*b)/60),d=a-3600*b-60*c;return 0<a?(10>b&&(b="0"+b),10>c&&(c="0"+c),10>d&&(d="0"+d),b+":"+c+":"+d):"00:00:00"}};
(function(a){var b=window,c=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new ActiveXObject("MSXML2.XMLHTTP.3.0")},function(){return new ActiveXObject("MSXML2.XMLHTTP")}],d=null;a.xhr=function(){if(null!=d)return d();for(var a=0,b=c.length;a<b;a++)try{var g=c[a],h=g();if(null!=h)return d=g,h}catch(k){}return function(){}};a._xhrResp=function(a){if(a.getResponseHeader("Content-Type"))switch(a.getResponseHeader("Content-Type").split(";")[0]){case "text/xml":return a.responseXML;
case "text/json":case "application/json":case "text/javascript":case "application/javascript":case "application/x-javascript":return b.JSON?JSON.parse(a.responseText):eval(a.responseText);default:return a.responseText}else return""};a._formData=function(a){var b=[],c=/%20/g,d;for(d in a)b.push(encodeURIComponent(d).replace(c,"+")+"="+encodeURIComponent(a[d].toString()).replace(c,"+"));return b.join("&")};a.xhrReq=function(b){var c=a.xhr(),d,h=0;b.userAgent="XMLHttpRequest";b.lang="en";b.dataType=
"application/x-www-form-urlencoded";b.timeout&&(d=setTimeout(function(){c.abort();b.timeoutFn&&b.timeoutFn(b.url)},b.timeout));c.onreadystatechange=function(){4==c.readyState?(d&&clearTimeout(d),0<c.status&&300>c.status?b.success&&b.success(a._xhrResp(c)):b.error&&b.error(c,c.status,c.statusText),b.complete&&b.complete(c,c.statusText)):b.progress&&b.progress(++h)};var k=b.url,m=null,n=(new Date).getTime(),l="POST"==b.type||"PUT"==b.type;!l&&b.data?k+="?"+a._formData(b.data):b.cached||(k+="?ts="+n);
c.open(b.type,k);l&&(m=(k=0<=b.dataType.indexOf("json"))?JSON.stringify(b.data):a._formData(b.data),c.setRequestHeader("Content-Type",k?"application/json":"application/x-www-form-urlencoded"));c.send(m)}})(window.T);var Styles={defaultFontSize:25,footer:{bgColor:"#4abad3",bgColorHover:"#3aa2bc",borderTop:"#5bcce9",borderColor1:"#389ab4",borderColor2:"#5bcce9",fontSize:20,height:85},topMenu:{bgColor:"rgba(62,172,200,0.95)",backButtonWith:240,shareButtonWith:80,borderBottom:"2px solid #e1e1e1",height:85,fontSize:45,fontWeight:"bold",color:"white"},hScroller:{bgColor:"#edebe6",numberOfPages:0,numberOfImages:T.isIPad?6:10},searchItem:{bgColor:"#edebe6",bgColorHover:"#f8f5f0"},dealInfo:{bottomHeight:166,content:{title:{fontSize:40,
fontFamily:"source-sans-pro, 'avenir', sans-serif",fontWeight:"normal",color:"#333333",lineHeight:1.3,paddingTop:12,paddingBottom:25}},bottom:{height:185,firstLineBgColor:"white",secondLineBgColor:"#6e6d6c",firstLineHeight:125,oldPrice:{padding:20,fontSize:32,fontFamily:"source-sans-pro",color:"#8e8e8e"},newPrice:{padding:18,fontFamily:"source-sans-pro",fontSize:54,fontWeight:"bold",color:"#e14427"},countdown:{fontSize:28,color:"white"},bought:{fontSize:28,color:"white"},buyBtn:{height:85,width:270,
fontSize:52,fontWeight:"bold",borderRadius:5,bgColor:"#48c55c",bgColorLight:"#57d86b",bgColorHover:"#38aa43",color:"white"}}},transitionTime:700};var Deals={loadedDeals:{},blurBackground:function(){T.isIOS&&(T.byId("pages-new").style.webkitFilter="blur("+T.px(15)+")",T.byId("top-menu-background").style.webkitFilter="blur("+T.px(15)+")")},removeBackgroundBlur:function(){T.isIOS&&(T.byId("pages-new").style.webkitFilter=null,T.byId("top-menu-background").style.webkitFilter=null)},showSharePage:function(){var a=T.byId("dealinfo-share-template").innerHTML,a=a.replace("%TITLE_MSG%",Messages.shareWithFriends),a=a.replace("%CANCEL_MSG%",Messages.cancel),
b=encodeURIComponent(Messages.shareText.replace("%NAME%",Deals.loadedDeals[App.currentDeal].title)).replace(/'/g,"%27"),c=encodeURIComponent(Messages.shareTitle).replace(/'/g,"%27"),d=encodeURIComponent(Messages.shareTextWithLink.replace("%NAME%",Deals.loadedDeals[App.currentDeal].title).replace("%LINK%",location.href)).replace(/'/g,"%27"),e=encodeURIComponent(Messages.viaTwitter).replace(/'/g,"%27"),a=a.replace(/%FACEBOOK%/g,"https://www.facebook.com/dialog/feed?app_id="+Messages.facebookAppId+"&display=popup&name="+
encodeURIComponent(Messages.shareFacebookText)+"&link="+encodeURIComponent(location.href)+"&caption="+encodeURIComponent(Deals.loadedDeals[App.currentDeal].title)+"&picture="+encodeURIComponent(Deals.loadedDeals[App.currentDeal].imageSrc)+"&redirect_uri="+encodeURIComponent(location.href)),a=a.replace(/%EMAIL%/g,("mailto:?subject="+c+"&body="+d).replace("%27","'")),a=a.replace(/%TWITTER%/g,"https://twitter.com/intent/tweet?url="+encodeURIComponent(location.href)+"&text="+b+"&via="+e);this.blurBackground();
T.byId("page-on-top").innerHTML=a;T.query(".dealinfo-share-block",1).style.marginTop=T.h()-4.5*T.p(80)+"px";T.byId("page-on-top").style.display="block"},hideSharePage:function(){this.removeBackgroundBlur();T.byId("page-on-top").style.display="none"},showCountdownInfoPage:function(){var a=T.byId("dealinfo-countdowninfo-template").innerHTML,a=a.replace("%INFO%",Messages.countdownInfo),a=a.replace("%CANCEL_MSG%",Messages.cancel);T.byId("page-on-top").innerHTML=a;T.byId("page-on-top").style.display="block";
T.query(".dealinfo-share-block",1).style.padding=T.px(20);a=T.query(".dealinfo-share-block",1).offsetHeight;T.query(".dealinfo-share-block",1).style.marginTop=T.h()-(a+T.p(120))+"px";T.query(".dealinfo-share-block",1).style.height=a+"px";this.blurBackground()},showBuyPage:function(a){var b=Deals.loadedDeals[a];App.showIFrame(b.title,Messages.buySrc.replace("%DEAL_ID%",b.id));App.changeHash("/buy/"+a)},showDeal:function(a){if(App.addPage()){var b,c;b=T.byId("pages-current");c=document.createElement("div");
c.id="pages-new";c.style.width=T.w()+"px";var d=T.byId("deal-page-template").innerHTML,e=T.byId("dealinfo-content-template").innerHTML,f=T.byId("dealinfo-bottom-template").innerHTML,d=d.replace("%CONTENT%",e);if(a)if(Deals.loadedDeals[a]){var g=Deals.loadedDeals[a],d=d.replace("%BACK%",Messages.backBtn),d=d.replace("%SHARE%",Messages.share),d=d.replace("%IMAGESRC%",g.imageSrc),d=d.replace("%MAP_ID%","dealinfo-map-"+g.id),d=d.replace("%SHORT_DESCRIPTION%",g.info),f=f.replace("%BULK%",T.formatNumber(g.bulk)+
" "+Messages.bought),f=f.replace("%SOLD_OUT%",g.isSoldOut);1==g.isSoldOut?(f=f.replace("%SOLD_OUT_CLASS%","dealinfo-bottom-buyBtn-soldOut"),f=f.replace("%BUY_MSG%",Messages.soldOut)):f=f.replace("%BUY_MSG%",Messages.buy);f=f.replace("%DEAL_ID%",g.id);f=f.replace("%OLDPRICE%",g.origPrice!=g.price&&0<g.origPrice?T.formatNumber(g.origPrice)+" "+Messages.kr:"");f=f.replace("%NEWPRICE%",T.formatNumber(g.price)+" "+Messages.kr)}else return!1;clearInterval(App.countDownInterval);var h=parseInt(g.endtime);
App.countDownInterval=setInterval(function(){var a=Math.floor((new Date).getTime()/1E3),a=h-a,b=Math.floor(a/3600),c=Math.floor((a-3600*b)/60),d=a-3600*b-60*c;0<a?(10>b&&(b="0"+b),10>c&&(c="0"+c),10>d&&(d="0"+d),T.query(".dealinfo-bottom-countdown").innerHTML=b+" "+Messages.hours+", "+c+" "+Messages.minutes+", "+d+" "+Messages.seconds+" "+Messages.left):T.query(".dealinfo-bottom-countdown").innerHTML=""},1E3);c.innerHTML=d;b.parentNode.appendChild(c);T.request("dealinfo",function(a){var b=T.query(".dealinfo-content-details"),
c=b.innerHTML;c&&(c=c.replace("%ABOUT%",a.about),c=c.replace("%ABOUT_MSG%",Messages.about),c=c.replace("%HIGHLIGHTS%",a.highlights),c=c.replace("%HIGHLIGHTS_MSG%",Messages.highlights),c=c.replace("%TERMS%",a.terms),c=c.replace("%TERMS_MSG%",Messages.terms),c=c.replace("%CONTACTS%",a.contacts),c=c.replace("%SELLER%",a.seller),c=c.replace("%SELLER_MSG%",Messages.seller),a.otherImg&&""!=a.otherImg&&-1<a.otherImg.indexOf("jpg")?(c=c.replace("%OTHER:",""),c=c.replace(":OTHER%",""),c=c.replace("%OTHER_MSG%",
Messages.other),c=c.replace("%OTHER_IMG%",'<img src="'+a.otherImg+"\" style=\"display:none;\" onload=\"T.query('.dealinfo-content-loading').style.display='none';this.style.display='block';if (App.dealInfoScroller) App.dealInfoScroller.refresh();\"/>")):c=c.replace(/%OTHER:.*:OTHER%/m,""),b.innerHTML=c,b.style.display="block",0<g.lat?(a=L.map("dealinfo-map-"+g.id,{zoomControl:!1}),a.addControl(L.control.zoom({position:"topright"})),a.setView([g.lat,g.lon],13),L.marker([g.lat,g.lon]).addTo(a),L.tileLayer("https://mts0.google.com/vt/lyrs=m@240000000&hl=sv&src=app&x={x}&y={y}&z={z}&s=Ga",
{attribution:"",maxZoom:19}).addTo(a)):T.byId("dealinfo-map-"+g.id).style.display="none",T.query(".content-loading",1).style.display="none",T.isIOS&&(App.dealInfoScroller&&App.dealInfoScroller.destroy(),App.dealInfoScroller=new IScroll(T.query(".dealinfo-wrapper"),{scrollbars:!0,hideScrollbarsOnMove:!0,speedRatio:0.4}),setTimeout(function(){App.dealInfoScroller.refresh()},500)))},{dealId:g.id},function(){T.query(".content-loading",1).style.display="none";if(T.isIOS)var a=new IScroll(T.query(".dealinfo-wrapper"),
{scrollbars:!0,hideScrollbarsOnMove:!0,speedRatio:0.4});setTimeout(function(){a.refresh()},500)});b=document.createElement("div");b.innerHTML=f;c.appendChild(b);T.initHover(T.query(".dealinfo-bottom-buyBtn"),Styles.dealInfo.bottom.buyBtn.bgColorHover,Styles.dealInfo.bottom.buyBtn.bgColor,1);T.initHover(T.query(".top-menu-back-btn, .top-menu-share-btn"),Styles.footer.bgColorHover);App.currentDeal=a;App.changeHash("/deal/"+a)}},appendDeals:function(a){App.mainPageHScroll.currentPageIndex=T.query("#hscroller-scroller-list > li:nth-child("+
(App.mainPageHScroll.currentPage.pageX+1)+") > div").id;var b=T.query("#deallist_"+a.index+" .deallist-item");App.isDealsLoading=1;Deals.loadDeals(a.index,b.length,Styles.hScroller.numberOfImages,function(b){T.byId("hscroller-scroller-loading").style.display="none";b?(T.isIOS&&(b.style.webkitTransition="opacity 0.8s",b.style.opacity=0),T.byId("deallist_"+a.index).appendChild(b),T.isIOS&&setTimeout(function(){b.style.opacity=1},200),App.isDealsLoading=0):setTimeout(function(){App.isDealsLoading=0},
1E3)},function(){T.byId("hscroller-scroller-loading").style.display="none";T.isIOS?(a.scrollTop-=1,setTimeout(function(){App.isDealsLoading=0},200)):App.isDealsLoading=0})},addNewList:function(a,b,c){if("undefined"==typeof b||null===b)b=Styles.hScroller.numberOfPages;var d=Templates.dealsPage(a.id),e=T.query("#hscroller-scroller-list > li:nth-child("+b+")"),f=document.createElement("li");f.innerHTML=d;if(!c||isNaN(c))c=Styles.hScroller.numberOfImages;d=f.firstChild;d.index=a.id;!T.isAndroid2&&!T.isIOS?
d.addEventListener("scroll",function(a){a=a.target;T.isIOS&&0==a.scrollTop&&(a.scrollTop=1);!App.isDealsLoading&&a.scrollTop>a.scrollHeight-1.3*T.h()&&(a.scrollTop>a.scrollHeight-1.5*T.h()&&(T.byId("hscroller-scroller-loading").style.display="block"),Deals.appendDeals(T.byId(App.mainPageHScroll.currentPageIndex)))}):(new FTScroller(d,{index:d.index,scrollingX:!1,scrollResponseBoundary:100,scrollBoundary:30})).addEventListener("reachedend",function(a){App.isDealsLoading||(T.byId("hscroller-scroller-loading").style.display=
"block",a=T.byId("wrapper_"+a.index),Deals.appendDeals(a))});0===e.length&&0!==b?T.byId("hscroller-scroller-list").appendChild(f):0===b?(e=T.byId("hscroller-scroller-list"),e.insertBefore(f,e.firstChild)):e.parentNode.insertBefore(f,e.nextSibling);e=Templates.dealsPageHeader(a);d=T.query("#top-menu-tabs > li:nth-child("+b+")");f=document.createElement("li");f.innerHTML=e;0===d.length&&0!==b?T.byId("top-menu-tabs").appendChild(f):0===b?(b=T.byId("top-menu-tabs"),b.insertBefore(f,b.firstChild)):d.parentNode.insertBefore(f,
d.nextSibling);f.firstChild.addEventListener("click",function(a){a=this.parentNode.parentNode.childNodes;for(var b in a)if("LI"==a[b].nodeName&&a[b].firstChild.id==this.id)return App.changeHScrollerPage(b)});a.categories?b=Templates.catDropdown(a.categories,function(b){var d=App.sections.concat(App.cities),e;for(e in d)d[e].id==a.id&&(d[e].currentCategory=b);b=T.query("#deallist_"+a.id+" > div");if(b.length)for(e=0;e<b.length;e++)b[e].parentNode.removeChild(b[e]);else b.parentNode&&b.parentNode.removeChild(b);
Deals.loadDeals(a.id,0,c,function(b){b&&T.byId("deallist_"+a.id).appendChild(b)})}):(b=document.createElement("div"),b.style.height=T.px(Styles.topMenu.height));T.byId("deallist_"+a.id).appendChild(b);Deals.loadDeals(a.id,0,c,function(b){b&&T.byId("deallist_"+a.id).appendChild(b)});Styles.hScroller.numberOfPages++;T.updateStyle("#hscroller-scroller",{width:T.w()*Styles.hScroller.numberOfPages+"px"});T.setW("top-menu-tabs",T.w()*Styles.hScroller.numberOfPages);App.mainPageHScroll&&App.mainPageHScroll.refresh()},
loadDeals:function(a,b,c,d,e){var f="",g=0,h=App.sections.concat(App.cities),k;for(k in h)h[k].id==a&&h[k].currentCategory&&(g=h[k].currentCategory);c||(c=Styles.hScroller.numberOfImages);T.request("deals",function(a){try{if(a.length){for(var b in a)Deals.loadedDeals[a[b].id]=a[b],f+=Templates.dealsItem(a[b]);var c=document.createElement("div");c.innerHTML=f;d(c)}else d(!1)}catch(g){console.error(g),e()}},{section:a,category:g,from:b,limit:c},function(){e(!1)})}};var Templates={dealsPage:function(a){return'<div class="main-v-wrapper" id="wrapper_'+a+'"><div class="deallist"><ul id="deallist_'+a+'"></ul></div></div>'},dealsItem:function(a){0<a.discount&&(a.title=a.title+" -"+a.discount+"%");return'<li onclick="Deals.showDeal('+a.id+')"><div class="deallist-item" style="background-image: url('+a.imageSrc+');"><div><div class="deallist-item-header">'+a.title+'</div><div class="deallist-item-footer"><div class="deallist-item-footer-bought">'+a.bulk+" köpta</div>"+
(a.timer?'<div class="deallist-item-footer-timer" data-endtime="'+a.endtime+'">'+T.getCountdownTime(a.endtime)+"</div>":"")+'<div class="deallist-item-footer-price '+(!a.timer?"deallist-item-without-timer":"")+'">'+(a.origPrice!=a.price&&0<a.origPrice?'<div class="deallist-item-footer-price-old">'+T.formatNumber(a.origPrice)+" kr</div>":"")+'<div class="deallist-item-footer-price-new">'+T.formatNumber(a.price)+" kr</div></div></div></div></div></li>"},dealsPageHeader:function(a){return'<a href="javascript:void(0)" id="header_'+
a.id+'">'+a.name+"</a>"},catDropdown:function(a,b){var c=document.createElement("select");c.className="categories-dropdown";var d=document.createElement("option");d.value="";d.selected=!0;d.innerHTML=Messages.seeAllCategories;c.appendChild(d);for(var e in a)d=document.createElement("option"),d.value=a[e].id,d.innerHTML=a[e].name,c.appendChild(d);c.onchange=function(){b(this.value)};c.ontouchend=function(){this.firstChild.innerHTML=Messages.viewAll};c.onclick=function(){this.firstChild.innerHTML=Messages.viewAll};
return c},prepareFooter:function(){T.updateStyle("#footer",{height:T.px(Styles.footer.height,1),boxShadow:!T.isAndroid2?"0px 0px "+T.px(50)+" 1px rgba(0,0,0,0.4)":""});T.updateStyle("#footer-tabs",{background:Styles.footer.bgColor,borderTop:T.px(1,1)+" solid "+Styles.footer.borderTop});T.updateStyle("#footer-tabs a",{height:T.px(Styles.footer.height,1),fontSize:T.px(Styles.footer.fontSize),backgroundSize:T.px(52)+" "+T.px(52),backgroundPosition:"50% "+T.px(18)});T.updateStyle("#footer-tabs-search",
{borderRight:T.px(1,1)+" solid "+Styles.footer.borderColor1});T.updateStyle("#footer-tabs-mydeals",{borderRight:T.px(1,1)+" solid "+Styles.footer.borderColor1});T.updateStyle("#footer-tabs-mydeals",{borderLeft:T.px(1,1)+" solid "+Styles.footer.borderColor2});T.updateStyle("#footer-tabs-city",{borderLeft:T.px(1,1)+" solid "+Styles.footer.borderColor2});T.initHover(T.query("#footer-tabs li"),Styles.footer.bgColorHover)},prepareNoConnection:function(){T.updateStyle("#splash-noconnection-button-pane",
{bottom:T.px(150)});T.updateStyle("#splash-noconnection-button",{top:T.px(10),padding:T.px(10)+" 0",fontSize:T.px(46),height:T.px(80),lineHeight:T.px(65),width:T.px(400),margin:"0 "+(T.w()-T.p(400))/2+"px"});T.updateStyle("#splash-noconnection-button-pane",{height:T.px(100)});T.updateStyle("#splash-noconnection-message",{bottom:T.px(270),fontSize:T.px(30)});T.updateStyle("#splash-noconnection-tag",{bottom:T.px(400)});950>T.h()&&(T.updateStyle("#splash",{backgroundPosition:"50% "+T.px(100)}),T.updateStyle("#splash-noconnection-button-pane",
{bottom:T.px(50)}),T.updateStyle("#splash-noconnection-message",{bottom:T.px(170)}),T.updateStyle("#splash-noconnection-tag",{bottom:T.px(300)}))},prepareHeader:function(){T.p(Styles.topMenu.fontSize)>T.w()/15&&(Styles.topMenu.fontSize=T.w()/T.p(15),Styles.topMenu.height=2*Styles.topMenu.fontSize);T.setH("top-menu-wrapper",T.p(Styles.topMenu.height));T.isStandalone&&(document.body.style.position="relative",document.body.style.top="20px",T.updateStyle(".dealinfo-share",{height:T.h()+"px"}));T.updateStyle("#top-menu-background",
{height:T.p(Styles.topMenu.height)+"px",background:Styles.topMenu.bgColor});var a=Math.ceil(T.p(Styles.topMenu.height)/5.66);T.isAndroid&&!T.isChrome?T.updateStyle("#top-menu-triangle",{height:a+"px",top:T.p(Styles.topMenu.height)-a+"px"}):(T.updateStyle("#top-menu-triangle",{display:"none"}),T.updateStyle("#top-menu-wrapper",{webkitClipPath:"polygon(0 0, 100% 0px, 100% "+T.px(Styles.topMenu.height)+", "+(T.w()/2+a)+"px "+T.px(Styles.topMenu.height)+", "+T.w()/2+"px "+(T.p(Styles.topMenu.height)-
a)+"px, "+(T.w()/2-a)+"px "+T.px(Styles.topMenu.height)+", 0 "+T.px(Styles.topMenu.height)+")"}));T.updateStyle("#top-menu-wrapper",{width:T.w()+"px"});T.updateStyle("#top-menu-wrapper ul",{width:T.w()*Styles.hScroller.numberOfPages+"px",paddingLeft:(T.w()-T.w()/2)/2+"px"});T.updateStyle("#top-menu-wrapper li",{width:T.w()/2+"px",height:T.px(Styles.topMenu.height),fontSize:T.px(Styles.topMenu.fontSize),fontWeight:Styles.topMenu.fontWeight,lineHeight:T.px(Styles.topMenu.height)});T.updateStyle("#top-menu-wrapper li a",
{color:Styles.topMenu.color});T.updateStyle(".top-menu",{color:Styles.topMenu.color,fontSize:T.px(Styles.topMenu.fontSize),fontWeight:Styles.topMenu.fontWeight});T.updateStyle(".top-menu-back-btn",{width:T.px(Styles.topMenu.backButtonWith),backgroundPosition:T.px(24)+" 50%",backgroundSize:T.px(24)+" "+T.px(42),fontSize:T.px(32),lineHeight:T.px(Styles.topMenu.height+5),paddingLeft:T.px(70)});T.updateStyle(".search-page .top-menu-back-btn",{width:T.px(80)});T.updateStyle(".top-menu-share-btn",{width:T.px(Styles.topMenu.shareButtonWith),
backgroundSize:T.px(80)+" "+T.px(80),lineHeight:T.px(Styles.topMenu.height+5),textAlign:"center",color:"white",fontSize:T.px(32)});T.updateStyle(".top-menu",{height:T.px(Styles.topMenu.height),borderBottom:T.px(1,1)+" solid rgba(170,169,164,0.5)",boxShadow:!T.isAndroid2?"0px "+T.px(1,1)+" "+T.px(2,1)+" "+T.px(1,1)+" rgba(170,169,164,0.3)":""});T.updateStyle(".top-menu-title",{width:T.w()-T.p(Styles.topMenu.backButtonWith)+"px",paddingLeft:T.px(20),lineHeight:T.px(Styles.topMenu.height)});var a=T.w()-
T.p(Styles.topMenu.backButtonWith+Styles.topMenu.shareButtonWith),b=(a-T.p(230))/2;0>b&&(b=0);T.updateStyle(".deal-page .top-menu-title",{width:a+"px",backgroundSize:"contain",backgroundPosition:b+"px 50%"});T.query("#top-menu-wrapper li:nth-child(1)").className="top-menu-tabs-active";T.updateStyle(".iframe-wrapper",{top:T.px(Styles.topMenu.height),bottom:0})},prepareSearch:function(){T.updateStyle(".top-menu-search",{width:T.w()-T.p(60)+"px"});T.updateStyle(".top-menu-search input",{margin:T.px(13)+
" 0 0 0",borderRadius:T.px(8),height:T.px(Styles.topMenu.height-25),fontFamily:"source-sans-pro, sans-serif",padding:T.px(0)+" "+T.px(5)+" 0 "+T.px(50),fontSize:T.px(30),width:T.w()-T.p(110)+"px",backgroundSize:T.px(37)+" "+T.px(25)});T.updateStyle("#top-menu-search-input-empty",{margin:T.px(13)+" 0 0 0",height:T.px(Styles.topMenu.height-25),left:T.w()-T.p(160)+"px",width:T.px(50),backgroundSize:T.px(50)+" "+T.px(29)});T.updateStyle(".search-wrapper",{top:T.px(Styles.topMenu.height),bottom:0});T.isIOS||
T.updateStyle(".search-wrapper",{overflowY:"scroll",webkitOverflowScrolling:"touch"});T.updateStyle(".search-item",{width:T.w()+"px",borderBottom:T.px(1,1)+"solid #aaa",padding:T.px(5)+" "+T.px(0)+" "+T.px(5)+" "+T.px(20),backgroundSize:T.px(18)+" "+T.px(27),backgroundPosition:T.w()-T.p(60)+"px 50%"});T.updateStyle(".item-active",{backgroundColor:Styles.searchItem.bgColorHover});T.updateStyle(".search-item-image",{borderRadius:T.px(8),margin:T.px(5)+" "+T.px(5)+" "+T.px(5)+" "+T.px(0),width:T.px(100)});
T.updateStyle(".search-item-image img",{height:T.px(100)});T.updateStyle(".search-item-text",{width:T.w()-T.p(200)+"px",marginTop:T.px(10),marginLeft:T.px(10)});T.updateStyle(".search-item-title",{fontSize:T.px(36)});T.updateStyle(".search-item-description",{fontSize:T.px(30),lineHeight:T.px(50)});T.updateStyle(".search-noresults",{top:T.px(Styles.topMenu.height),bottom:0});T.updateStyle(".search-noresults-title",{padding:T.px(100)+" 0 "+T.px(40)+" 0",textAlign:"center",fontWeight:"bold",fontSize:T.px(48),
color:"#373737"});T.updateStyle(".search-noresults-description",{width:T.w()+"px",padding:"0 "+T.px(100),overflow:"hidden",textOverflow:"ellipsis",textAlign:"center",fontSize:T.px(30),color:"#747372"});T.updateStyle(".search-cat-header",{height:T.px(100),fontSize:T.px(36),fontWeight:"bold",lineHeight:T.px(100),padding:"0 0 0 "+T.px(30),borderBottom:T.px(1,1)+" solid #aaa"});T.updateStyle(".search-cat-image",{backgroundSize:T.px(48)+" "+T.px(48),width:T.px(80),height:T.px(90)});T.updateStyle(".search-cat-title",
{fontSize:T.px(36),width:T.w()-T.p(170)+"px",height:T.px(90)});T.updateStyle(".search-cat",{height:T.px(90),fontSize:T.px(36),fontWeight:"normal",lineHeight:T.px(95),color:"rgba(0,0,0,0.75)",borderBottom:T.px(1,1)+" solid #aaa",padding:"0 0 0 "+T.px(10),backgroundSize:T.px(18)+" "+T.px(27),backgroundPosition:T.w()-T.p(60)+"px 50%"});T.updateStyle(".changecity-item",{width:T.w()+"px",borderBottom:T.px(1,1)+"solid #aaa",padding:T.px(5)+" "+T.px(0)+" "+T.px(5)+" "+T.px(0)});T.updateStyle(".changecity-item-title",
{marginLeft:T.px(20),lineHeight:T.px(90),fontSize:T.px(40)})},prepareSplash:function(){T.updateStyle("#splash",{"background-size":T.p(559)+"px "+T.px(359),"background-position":"50% "+T.px(150)});T.updateStyle("#splash-loading",{top:T.px(640),height:T.px(60),"background-size":T.px(60)});T.updateStyle("#splash-message",{top:T.px(720),"font-size":T.px(30)});T.byId("splash-message").innerHTML=Messages.loadingDeals;T.byId("splash").style.display="block"},prepareHScroller:function(){T.setH("hscroller-wrapper",
T.h()-T.p(Styles.footer.height,1)+1);T.updateStyle("#hscroller-scroller",{top:0,height:T.h()-T.p(Styles.footer.height,1)+1+"px",width:T.w()*Styles.hScroller.numberOfPages+"px",borderTop:T.px(2)+" solid "+Styles.hScroller.bgColor});T.updateStyle("#hscroller-scroller-background",{backgroundSize:"1px "+T.px(65),height:T.px(64),top:T.h()-T.p(Styles.topMenu.height+Styles.footer.height+60)+"px"});T.updateStyle("#hscroller-scroller-list",{backgroundSize:"1px "+T.px(64),backgroundColor:Styles.hScroller.bgColor});
T.updateStyle("#hscroller-scroller-list > li","width",T.w()+"px");T.updateStyle(".ftscroller_scrollbary",{top:T.px(Styles.topMenu.height)});App.mainPageHScroll=new IScroll(T.byId("hscroller-wrapper"),{scrollX:!0,scrollY:0,snap:!0,momentum:!1,snapThreshold:0.1,lockDirection:!0,directionLockThreshold:20,eventPassthrough:"vertical",preventDefault:!0,indicators:[{notUseTransform:1,el:T.byId("top-menu-wrapper"),resize:0,ignoreBoundaries:!0,speedRatioX:0.5,listenY:!1}]});App.mainPageHScroll.currentPageIndex=
T.query("#hscroller-scroller-list > li:nth-child(1) > div").id;App.mainPageHScroll.on("translate",function(){T.query("#top-menu-wrapper li.top-menu-tabs-active").className="";T.query("#top-menu-wrapper li:nth-child("+(this.currentPage.pageX+1)+")").className="top-menu-tabs-active";App.mainPageHScroll.currentPageIndex=T.query("#hscroller-scroller-list > li:nth-child("+(this.currentPage.pageX+1)+") > div").id});App.mainPageHScroll.scrollActive=0;App.mainPageHScroll.on("scrollStart",function(){App.mainPageHScroll.scrollActive=
1});App.mainPageHScroll.on("scrollEnd",function(){App.mainPageHScroll.scrollActive=0})},prepareDeals:function(){T.isIOS||T.updateStyle(".main-v-wrapper",{overflowY:"scroll",webkitOverflowScrolling:"touch"});var a=0,b,c=!1;T.isDesktop&&(a=8/((window.outerWidth-8)/window.innerWidth));var d=T.w()-T.p(30);if(600<T.w()&&!T.isAndroid&&!T.isIOS||90==Math.abs(window.orientation))c=!0,d=T.w()/2-T.p(21.5);T.is2Columns=c;var e=290/(510/d);b=d/e<510/290?"auto "+e+"px":d+"px auto";T.updateStyle(".deallist-item",
{margin:T.p(22)+"px 0 0 "+T.p(15,1)+"px",height:e+T.px(50)+"px",width:d-a+"px",border:T.px(1,1)+" solid white",boxShadow:!T.isAndroid2?"0px 1px 1px 1px rgba(204,202,197,0.75)":"",borderRadius:!T.isAndroid2?T.px(2,1):"",webkitBackgroundSize:d+"px "+e+"px",backgroundSize:b,backgroundPosition:"50% 0"});a=e/3;T.updateStyle(".deallist-item-header",{height:T.p(50)+a+"px",paddingLeft:T.px(15),paddingTop:a+"px",backgroundSize:"1px "+(T.p(50)+a+10)+"px",lineHeight:T.px(50),color:"white",marginTop:e-(T.p(50)+
a)+"px",fontSize:!c?T.px(36):T.px(30),textShadow:!T.isAndroid2?"0px 1px 2px rgba(0, 0, 0, 0.5)":""});T.updateStyle(".deallist-item-footer",{borderTop:"1px solid #cccac5",height:T.px(60)});T.updateStyle(".deallist-item-without-timer",{marginLeft:T.px(160)});T.updateStyle(".deallist-item-footer-bought",{width:T.p(140)+"px",background:"#edebe6",color:"#545351",textAlign:"center",fontFamily:"source-sans-pro",fontSize:!c?T.px(26):T.px(22),lineHeight:!c?T.px(65):T.px(60)});T.updateStyle(".deallist-item-footer-timer",
{width:T.p(140)+"px",marginLeft:T.px(3),paddingLeft:T.px(25),backgroundColor:"#edebe6",backgroundSize:T.px(20),backgroundPosition:T.px(12)+" "+T.px(21.5),color:"#545351",textAlign:"center",fontFamily:"source-sans-pro",fontSize:!c?T.px(26):T.px(22),lineHeight:!c?T.px(65):T.px(60)});T.updateStyle(".deallist-item-footer-price",{"float":"right",marginRight:T.px(20),lineHeight:T.px(60)});T.updateStyle(".deallist-item-footer-price-new",{color:"#d72e1e",fontWeight:"bold",fontFamily:"source-sans-pro",margin:"0 0 0 "+
T.px(5),fontSize:!c?T.px(45):T.px(30),lineHeight:T.px(60)});T.updateStyle(".deallist-item-footer-price-old",{color:"#8f8f8f",fontSize:!c?T.px(26):T.px(22),fontFamily:"source-sans-pro",textDecoration:"line-through",lineHeight:!c?T.px(65):T.px(60)});T.updateStyle(".deallist > ul",{paddingBottom:T.px(80)});T.updateStyle(".loading-icon",{bottom:T.px(10),height:T.px(50),webkitBackgroundSize:T.px(48)+" "+T.px(48),backgroundSize:T.px(48)+" "+T.px(48)});T.updateStyle(".categories-dropdown",{width:T.w()-T.p(28)-
(T.isDesktop?16:0)+"px",fontSize:T.px(30),fontWeight:"lighter",padding:"0 "+T.px(40)+" 0 "+T.px(20),margin:T.px(Styles.topMenu.height+18)+" "+T.px(5)+" 0 "+T.px(15),lineHeight:T.px(70),color:"#555",border:T.p(1)+"px solid #d4d2cf",borderRadius:!T.isAndroid2?T.px(2,1):"",backgroundSize:T.px(40),boxShadow:!T.isAndroid2?"0px 1px 1px 1px rgba(204,202,197,0.75)":""})},preparePages:function(){T.setW("pages-scroller",5*T.w());T.updateStyle("#pages-scroller > div",{width:T.w()+"px"});App.pagesScroll=new IScroll(T.byId("pages-wrapper"),
{scrollX:!0,scrollY:0});App.pagesScroll.disable()},prepareDealInfo:function(){var a=Styles.dealInfo.bottom;T.updateStyle(".dealinfo-wrapper",{top:0,bottom:T.px(a.height)});T.updateStyle(".dealinfo-content-padding",{height:T.px(Styles.topMenu.height)});T.isIOS||T.updateStyle(".dealinfo-wrapper",{overflowY:"scroll",webkitOverflowScrolling:"touch"});T.updateStyle(".dealinfo-bottom",{width:T.w()+"px",boxShadow:!T.isAndroid2?"0px 0px "+T.px(50)+" 0px rgba(0,0,0,0.25)":"",bottom:0});T.updateStyle(".dealinfo-bottom-firstline",
{height:T.px(a.firstLineHeight),lineHeight:T.px(a.firstLineHeight+5),backgroundColor:a.firstLineBgColor});T.updateStyle(".dealinfo-bottom-secondline",{height:T.px(a.height-a.firstLineHeight),lineHeight:T.px(a.height-a.firstLineHeight+5),backgroundColor:a.secondLineBgColor});T.updateStyle(".dealinfo-bottom-price-old",{paddingLeft:T.px(a.oldPrice.padding),fontSize:T.px(a.oldPrice.fontSize),paddingTop:T.px(a.oldPrice.fontSize/5),fontFamily:a.newPrice.fontFamily,textDecoration:"line-through",color:a.oldPrice.color});
T.updateStyle(".dealinfo-bottom-price-new",{paddingLeft:T.px(a.newPrice.padding),fontSize:T.px(a.newPrice.fontSize),fontFamily:a.newPrice.fontFamily,fontWeight:a.newPrice.fontWeight,color:a.newPrice.color});T.updateStyle(".dealinfo-bottom-buyBtn",{marginTop:T.px((a.firstLineHeight-a.buyBtn.height)/2),marginRight:T.px(a.oldPrice.padding),width:T.px(a.buyBtn.width),height:T.px(a.buyBtn.height),color:a.buyBtn.color,borderRadius:T.p(a.buyBtn.borderRadius)+"px",textAlign:"center",background:"-webkit-linear-gradient(top, "+
a.buyBtn.bgColorLight+" 0%, "+a.buyBtn.bgColor+" 100%)",fontSize:T.px(a.buyBtn.fontSize),lineHeight:T.px(a.buyBtn.height+5),fontWeight:a.buyBtn.fontWeight,textTransform:"uppercase",boxShadow:!T.isAndroid2?"inset 0 "+T.px(-4)+" "+T.px(1)+" "+T.px(1)+" #339a3c":""});T.updateStyle(".dealinfo-bottom-buyBtn-soldOut",{fontSize:T.px(a.buyBtn.fontSize-6),background:"#b5b5b5",boxShadow:!T.isAndroid2?"inset 0 "+T.px(-4)+" "+T.px(1)+" "+T.px(1)+" #a9a9a9":""});T.updateStyle(".dealinfo-bottom-bought",{paddingLeft:T.px(a.oldPrice.padding),
fontSize:T.px(a.bought.fontSize),fontFamily:a.newPrice.fontFamily,color:a.bought.color});T.updateStyle(".dealinfo-bottom-countdown",{paddingRight:T.px(a.newPrice.padding),fontSize:T.px(a.countdown.fontSize),fontFamily:a.newPrice.fontFamily,color:a.countdown.color});T.updateStyle(".dealinfo-bottom-infoIcon",{width:T.px(60),height:T.px(60),backgroundSize:T.px(25)+" "+T.px(25)});var b=T.w();T.h()<T.w()?(b=T.h(),T.updateStyle(".dealinfo-content",{padding:"0 "+(T.w()-b)/2+"px"}),T.updateStyle(".dealinfo-content-wrapper",
{padding:T.px(10)+" "+T.px(0),background:"#edebe6"})):T.updateStyle(".dealinfo-content-wrapper",{padding:T.px(10)+" "+T.px(20),background:"#edebe6"});a=Styles.dealInfo.content;T.updateStyle(".dealinfo-content-image",{width:b+"px",height:290*(b/510)+"px"});T.updateStyle(".dealinfo-content-title",{color:a.title.color,lineHeight:a.title.lineHeight,fontFamily:a.title.fontFamily,fontSize:T.px(a.title.fontSize),fontWeight:a.title.fontWeight,paddingTop:T.px(a.title.paddingTop),paddingBottom:T.px(a.title.paddingBottom)});
T.updateStyle(".content-loading",{height:T.px(48),backgroundSize:"contain"});T.updateStyle(".dealinfo-content-block",{border:T.px(1)+" solid #c6c6c6",background:"white",boxShadow:!T.isAndroid2?"0px 1px "+T.px(1,1)+" "+T.px(1,1)+" rgba(0,0,0,0.05)":"",borderRadius:!T.isAndroid2?T.px(4,1):"",marginBottom:T.px(30),overflow:"hidden"});T.updateStyle(".dealinfo-content-map",{height:T.px(400),border:T.px(1,1)+" solid #c6c6c6",boxShadow:!T.isAndroid2?"0px 1px "+T.px(1,1)+" "+T.px(1,1)+" rgba(0,0,0,0.05)":
"",marginBottom:T.px(10),overflow:"hidden"});T.updateStyle(".dealinfo-content-block-title",{background:"#3eacc8",paddingLeft:T.px(15),height:T.px(65),lineHeight:T.px(65),color:"white",fontSize:T.px(36),fontWeight:"bold",overflow:"hidden"});T.updateStyle(".dealinfo-content-block h5",{paddingTop:T.px(5),fontWeight:"bold",fontSize:T.px(30)});T.updateStyle(".dealinfo-content-block h5 > strong",{display:"block",marginTop:T.px(40),fontSize:T.px(30),fontWeight:"bold",color:"#333333"});T.updateStyle(".dealinfo-content-block p",
{paddingTop:T.px(10)});T.updateStyle(".dealinfo-content-block-content",{padding:T.px(10)+" "+T.px(25)+" "+T.px(25)+" "+T.px(25),color:"#555",fontSize:T.px(30),lineHeight:1.3});T.updateStyle(".dealinfo-content-contacts",{padding:"0 "+T.px(10),color:"#555",fontSize:T.px(30)});T.updateStyle(".dealinfo-content-contacts h5",{fontSize:T.px(30),color:"#333",paddingTop:T.px(10)});T.updateStyle(".dealinfo-content-contacts h5 strong",{fontWeight:"normal"});T.updateStyle(".dealinfo-share",{backgroundColor:T.isIOS?
"rgba(27,71,81,0.33)":"rgba(0,0,0,0.75)"});T.updateStyle(".dealinfo-share-block div, .dealinfo-share-block a",{height:T.px(80),lineHeight:T.px(80)});T.updateStyle(".dealinfo-share-block",{width:T.w()-2*T.p(20),margin:T.px(20),borderRadius:T.px(5)});T.updateStyle(".dealinfo-share-block-title",{fontSize:T.px(25)});T.updateStyle(".dealinfo-share-item",{fontSize:T.px(35)})},prepareModalPages:function(){T.updateStyle(".noconnection-page",{height:T.h()+"px"});T.updateStyle(".noconnection-tag",{marginTop:T.px(140),
height:T.px(160),backgroundSize:T.px(338)+" "+T.px(160)});T.updateStyle(".noconnection-msg",{marginTop:T.px(30),fontSize:T.px(35)});T.updateStyle(".noconnection-title",{fontSize:T.px(40)});T.updateStyle(".instructions-page",{height:T.h()+"px"});T.updateStyle(".instructions-img-h",{height:T.px(250),backgroundSize:"contain"});T.updateStyle(".instructions-img-v",{height:T.px(250),backgroundSize:"contain"});T.updateStyle(".instructions-title",{marginTop:T.px(40),fontSize:T.px(60),fontWeight:"bold"});
T.updateStyle(".instructions-msg",{marginTop:T.px(30),fontSize:T.px(40)})}};var App={pagesNumber:1,isDealsLoading:0,inTransition:0,hashChanged:0,showIFrame:function(a,b){if(T.isIOS)return/safari/i.test(navigator.userAgent)&&(b=b.replace("device=app","device=no")),location.href=b+"&is_touch=1",!1;if(App.addPage()){var c,d;c=T.byId("pages-current");d=document.createElement("div");d.id="pages-iframe";d.style.width=T.w()+"px";var e=T.byId("iframe-page-template").innerHTML,e=e.replace("%TITLE%",a),e=e.replace('src=""','src="'+b+'"'),e=e.replace('onload=""',"onload=\"T.query('.content-loading-iframe').style.display='none'; this.style.display='block'\"");
d.innerHTML=e;c.parentNode.appendChild(d);T.initHover(T.query(".top-menu-back-btn"),Styles.footer.bgColorHover)}},lastCheckConnectionTs:(new Date).getTime(),checkDealsTimer:function(){var a=document.querySelectorAll("#"+App.mainPageHScroll.currentPageIndex+" .deallist-item-footer-timer"),b;for(b in a)a[b].getAttribute&&(a[b].innerHTML=T.getCountdownTime(a[b].getAttribute("data-endtime")))},checkConnectionInterval:5E3,checkConnection:function(a){if(a||(new Date).getTime()-App.lastCheckConnectionTs>
180*App.checkConnectionInterval)if(App.initialized){a=1;var b;try{b=App.mainPageHScroll.currentPageIndex.substr(8);var c=T.query("#deallist_"+b+" > div",!1);a=c.length;for(var d=0;d<a;d++)c[d].parentNode.removeChild(c[d])}catch(e){b="shopping"}T.byId("hscroller-scroller-loading").style.display="block";Deals.loadDeals(b,0,Styles.hScroller.numberOfImages*a,function(a){App.hideNoConnection();a&&(T.byId("deallist_"+b).appendChild(a),T.byId("hscroller-scroller-loading").style.display="none")})}else App.init(),
T.byId("container").style.display="block";App.lastCheckConnectionTs=(new Date).getTime()},hideNoConnection:function(){App.isOffline=!1;T.byId("container").style.display="block";T.byId("splash").style.display="none"},showNoConnection:function(){App.isOffline=!0;var a=T.byId("noconnection-template").innerHTML,a=a.replace("%TITLE%",Messages.noConnectionTitle),a=a.replace("%MSG%",Messages.noConnectionMsg);T.byId("container").style.display="none";T.byId("splash-message").style.display="none";T.byId("splash-loading").style.display=
"none";T.byId("splash").style.display="block";T.byId("splash-noconnection").style.display="block";T.byId("splash-noconnection").innerHTML=a},showMyDeals:function(){App.showIFrame(Messages.myDeals,Messages.myDealsSrc)},showInstructions:function(){if(!window.localStorage||!window.localStorage.getItem("instructionsShown")){var a=T.byId("instructions-template").innerHTML,a=a.replace("%TITLE%",Messages.instructionsTitle),a=a.replace("%MSG_H%",Messages.instructionsHorizontal),a=a.replace("%MSG_V%",Messages.instructionsVertical);
T.byId("page-on-top").innerHTML=a;T.byId("page-on-top").style.display="block"}},hideInstructions:function(){try{window.localStorage.setItem("instructionsShown",1)}catch(a){}T.byId("page-on-top").innerHTML="";T.byId("page-on-top").style.display="none"},addSearchItem:function(a){Deals.loadedDeals[a.id]=a;var b=document.createElement("div"),c=T.byId("search-item-template").innerHTML,d="";T.inArray(a.type,App.sections,"id")&&(d=App.sections[T.inArray(a.type,App.sections,"id")].name);T.inArray(a.type,
App.cities,"id")&&(d=App.cities[T.inArray(a.type,App.cities,"id")].name);c=c.replace("%TITLE%",a.title);c=c.replace("%DESCRIPTION%",d+": "+a.info);c=c.replace("%IMG%",'<img src="'+a.smallimage+'" onload="this.style.display=\'block\'"/>');b.onclick=function(){Deals.showDeal(a.id)};b.className="search-item";b.innerHTML=c;T.initHover(b,Styles.searchItem.bgColorHover);T.query(".search-scroller").appendChild(b);App.searchScroller&&App.searchScroller.refresh()},searchByCategory:function(a,b){T.query(".search-scroller").innerHTML=
"";App.searchInputSetValue(b);T.query(".search-noresults").style.display="none";App.lastSearch!=a&&(App.lastSearch=a,T.request("dealsearch",function(b){if(b.length)for(var d in b)App.addSearchItem(b[d]);else""!=a?(T.query(".search-noresults").style.display="block",T.query(".search-noresults-keyword").innerHTML=a):(T.query(".search-noresults").style.display="none",T.query(".search-scroller").innerHTML=T.byId("search-categories-template").innerHTML)},{text:App.lastSearch,city:App.currentCityId},function(){}));
App.changeHash("/search/"+a)},searchInputSetValue:function(a){T.query(".top-menu-search-input",1).value=a;""!=a?T.query("#top-menu-search-input-empty").style.display="block":T.query("#top-menu-search-input-empty").style.display="none"},searchDeal:function(a){T.query(".search-scroller").innerHTML="";-1==a.indexOf("section:")&&App.searchInputSetValue(a);T.query(".search-noresults").style.display="none";App.lastSearch!=a?(App.lastSearch=a,T.request("dealsearch",function(b){if(b.length)for(var c in b)App.addSearchItem(b[c]);
else""!=a?(T.query(".search-noresults").style.display="block",T.query(".search-noresults-keyword").innerHTML=a):(T.query(".search-noresults").style.display="none",T.query(".search-scroller").innerHTML=T.byId("search-categories-template").innerHTML);T.isIOS?App.searchScroller.scrollTo(0,0):T.query(".search-scroller").scrollTop=0},{text:App.lastSearch,city:App.currentCityId},function(){})):(T.query(".search-noresults").style.display="none",T.query(".search-scroller").innerHTML=T.byId("search-categories-template").innerHTML);
App.changeHash("/search/"+a)},showSearchPage:function(){if(App.addPage()){var a,b;a=T.byId("pages-current");b=document.createElement("div");b.id="pages-search";b.style.width=T.w()+"px";var c=T.byId("search-page-template").innerHTML,c=c.replace("%PLACEHOLDER%",Messages.searchPlaceholder);b.innerHTML=c;a.parentNode.appendChild(b);a=T.byId("search-categories-template").innerHTML;a=a.replace("%HEADER%",Messages.searchCategories);b=T.byId("search-categories-item-template").innerHTML;var c="",d;for(d in App.searchCategories)var e=
b,e=e.replace(/%ICON%/g,App.searchCategories[d].icon),e=e.replace(/%NAME%/g,App.searchCategories[d].name),e=e.replace(/%ID%/g,App.searchCategories[d].id),c=c+e;a=a.replace("%CATEGORIES%",c);T.byId("search-categories-template").innerHTML=a;T.query(".search-scroller").innerHTML=a;T.initHover(T.query(".search-cat"),Styles.searchItem.bgColorHover);T.isIOS&&(App.searchScroller&&App.searchScroller.destroy(),App.searchScroller=new IScroll(T.query(".search-wrapper"),{scrollbars:!0,hideScrollbarsOnMove:!0}));
T.query(".top-menu-search-input").addEventListener("input",function(){""!=this.value?T.query("#top-menu-search-input-empty").style.display="block":T.query("#top-menu-search-input-empty").style.display="none";App.searchDeal(this.value)});T.query("#top-menu-search-input-empty").addEventListener("click",function(){App.searchInputSetValue("");App.searchDeal("");T.query(".top-menu-search-input").focus()});T.query("#top-menu-search-input-empty").addEventListener("touchstart",function(){this.style.opacity=
0.5});T.query("#top-menu-search-input-empty").addEventListener("touchend",function(){this.style.opacity=1});T.query(".search-noresults-title").innerHTML=Messages.noResults;T.query(".search-noresults-description").innerHTML=Messages.noResultsDescription;App.changeHash("/search/")}},addChangeCityItem:function(a){var b=document.createElement("div"),c=T.byId("changecity-item-template").innerHTML,c=c.replace("%TITLE%",a.name);b.className="changecity-item";a.id==App.currentCityId&&(b.className+=" item-active");
b.innerHTML=c;b.onclick=function(){var b=App.currentCityId;App.currentCityId=a.id;var c=T.query("#hscroller-scroller-list > li:nth-child(1)"),f=0;c.parentNode.removeChild(c);c=T.query("#top-menu-tabs > li:nth-child(1)");"top-menu-tabs-active"==c.className&&(f=1);c.parentNode.removeChild(c);"default"!=b&&(c=T.query("#hscroller-scroller-list > li:nth-child(2)"),f=0,c.parentNode.removeChild(c),c=T.query("#top-menu-tabs > li:nth-child(2)"),"top-menu-tabs-active"==c.className&&(f=1),c.parentNode.removeChild(c));
if("default"==App.currentCityId)Deals.addNewList(App.startCities[App.startCities.length-1],0),window.localStorage.setItem("userCityId",App.currentCityId);else for(var g in App.cities)if(App.cities[g].id==a.id){Deals.addNewList(App.cities[g],1);Deals.addNewList(App.startCities[g],0);try{window.localStorage.setItem("userCityId",App.cities[g].id)}catch(h){}f&&(T.query("#top-menu-tabs > li:nth-child(2)").className="top-menu-tabs-active")}"default"!=b&&Styles.hScroller.numberOfPages--;Styles.hScroller.numberOfPages--;
T.updateStyle("#hscroller-scroller",{width:T.w()*Styles.hScroller.numberOfPages+"px"});App.mainPageHScroll.goToPage(0,0,0);App.mainPageHScroll.refresh();App.goBack()};T.initHover(b,Styles.searchItem.bgColorHover);T.query(".changecity-scroller").appendChild(b);App.searchScroller&&App.searchScroller.refresh()},showChangeCityPage:function(){if(App.addPage()){var a,b;a=T.byId("pages-current");b=document.createElement("div");b.id="pages-changecity";b.style.width=T.w()+"px";var c=T.byId("changecity-page-template").innerHTML,
c=c.replace("%TITLE%",Messages.selectCity);b.innerHTML=c;a.parentNode.appendChild(b);T.isIOS&&(App.cityScroller&&App.cityScroller.destroy(),App.cityScroller=new IScroll(T.query(".search-wrapper"),{scrollbars:!0,hideScrollbarsOnMove:!0}));for(var d in App.cities)App.addChangeCityItem(App.cities[d]);App.addChangeCityItem({id:"default",name:Messages.restOfCountry});T.initHover(T.query(".top-menu-back-btn"),Styles.footer.bgColorHover);App.changeHash("/city/")}},changeHScrollerPage:function(a){a=parseInt(a);
setTimeout(function(){App.mainPageHScroll.goToPage(a,0,Styles.transitionTime,IScroll.ease.quadratic2);T.query("#top-menu-wrapper li.top-menu-tabs-active").className="";T.query("#top-menu-wrapper li:nth-child("+(a+1)+")").className="top-menu-tabs-active"},100)},addPage:function(){if(!App.inTransition&&!App.mainPageHScroll.scrollActive){var a=T.byId("pages-current");"pages-iframe"==a.parentNode.lastChild.id&&a.parentNode.removeChild(a.parentNode.lastChild);App.inTransition=1;T.byId("pages-wrapper").style.display=
"block";5<=App.pagesNumber&&(T.setW("pages-scroller",T.w()*(App.pagesNumber+1)),App.pagesScroll.refresh());App.pagesScroll.scrollBy(-T.w(),0,Styles.transitionTime);App.pagesNumber++;setTimeout(function(){App.inTransition=0},Styles.transitionTime);return!0}return!1},goBack:function(a){var b=window.location.hash;if(!a&&-1<b.indexOf("search")&&-1<b.indexOf("section"))return App.searchDeal(""),!1;clearInterval(App.countDownInterval);App.pagesScroll.scrollBy(T.w(),0,Styles.transitionTime);setTimeout(function(){var a=
T.byId("pages-current");a.parentNode.removeChild(a.parentNode.lastChild);App.pagesNumber--;1==App.pagesNumber&&App.changeHash("")},Styles.transitionTime);return!0},changeHash:function(a){App.hashChanged=1;window.location.hash=a;setTimeout(function(){App.hashChanged=0},200)},hashChangeEvent:function(a){if(!App.hashChanged){var b=a.oldURL;a=a.newURL;b=b.substr(b.indexOf("#"));a=a.substr(a.indexOf("#"));"#"!=b?(b=b.split("/"),a=a.split("/"),""!=b[1]&&b[1]!=a[1]?(T.isIOS&&"deal"==b[1]&&Deals.hideSharePage(),
App.goBack(!0)):"search"==b[1]&&("search"==a[1]&&""!=b[2])&&App.searchDeal(a[2])):App.changeHash("")}},checkLocation:function(){var a=window.location.hash;if(""!=a)switch(a=a.split("/"),a[1]){case "buy":case "deal":(a=parseInt(a[2],10))&&(Deals.loadedDeals[a]?Deals.showDeal(a):T.request("getdeal",function(a){Deals.loadedDeals[a.id]=a;Deals.showDeal(a.id)},{dealId:a}));break;case "search":App.showSearchPage();a[2]&&App.searchDeal(a[2]);break;case "city":App.showChangeCityPage();break;case "mydeals":App.showMyDeals()}else 2==
App.pagesNumber&&App.goBack()},init:function(){FastClick.attach(document.body);T.checkStandalone();var a=1136,b=screen.availHeight;90==Math.abs(window.orientation)&&(b=screen.availWidth);T.isAndroid&&(b/=window.devicePixelRatio);!T.isDesktop&&20<b-window.innerHeight&&(a-=2.5*(b-window.innerHeight));T.scale=!window.orientation||180==window.orientation?T.h()/a:T.h()/800;document.body.style["font-size"]=T.p(Styles.defaultFontSize)+"px";T.setH("container",T.h());Templates.prepareSplash();Templates.prepareNoConnection();
T.request("sections",function(a){App.sections=a.sections;App.cities=a.cities;App.startCities=a.startCities;App.searchCategories=a.searchCategories;var b=!1;try{b=window.localStorage.getItem("userCityId")}catch(e){}if(b||3<location.hash.length)if(b||(b="default"),App.currentCityId=b,"default"!=b)for(g in App.cities)App.cities[g].id==b&&(Deals.addNewList(App.startCities[g]),setTimeout(function(){Deals.addNewList(App.cities[g],2)},0));else Deals.addNewList(App.startCities[App.startCities.length-1]);
else{var f=function(b){T.xhrReq({url:"http://ipinfo.io/json",dataType:"json",cached:1,type:"GET",timeout:3E3,success:function(b){console.log("checkByIp success");var d=99999,e=0,f;for(g in App.cities)f=T.getDistance(b.loc.split(","),[App.cities[g].latitude,App.cities[g].longitude]),d>f&&(d=f,e=g);150<d?(e=App.startCities.length-1,App.currentCityId="default"):App.currentCityId=a.cities[e].id;try{window.localStorage.setItem("userCityId",App.currentCityId)}catch(h){}"default"!=App.currentCityId&&Deals.addNewList(App.cities[e],
1);Deals.addNewList(App.startCities[e],0);App.checkLocation()},error:function(){console.log("checkByIp error");Deals.addNewList(App.startCities[App.startCities.length-1],0);App.checkLocation()}})};navigator.geolocation?navigator.geolocation.getCurrentPosition(function(b){console.log("getCurrentPosition success");var d=99999,e=0,f=b.coords;for(g in App.cities)b=T.getDistance([f.latitude,f.longitude],[App.cities[g].latitude,App.cities[g].longitude]),d>b&&(d=b,e=g);150<d?(e=App.startCities.length-1,
App.currentCityId="default"):App.currentCityId=a.cities[e].id;try{window.localStorage.setItem("userCityId",App.currentCityId)}catch(l){}"default"!=e&&Deals.addNewList(App.cities[e],1);Deals.addNewList(App.startCities[e],0);App.checkLocation()},function(a){console.log("getCurrentPosition error");f(a)},{enableHighAccuracy:!0,timeout:3E3,maximumAge:0}):f()}Templates.preparePages();Templates.prepareHeader();Templates.prepareHScroller();Templates.prepareDeals();Templates.prepareDealInfo();Templates.prepareFooter();
Templates.prepareSearch();Templates.prepareModalPages();for(var g in a.sections)Deals.addNewList(a.sections[g],null,T.is2Columns?8:4);b&&App.checkLocation();setTimeout(function(){T.byId("container").style.opacity=1;T.isStandalone&&(document.body.style.backgroundColor="#40a3b9");T.byId("splash").style.display="none";navigator.splashscreen&&setTimeout(function(){navigator.splashscreen.hide()},500);App.showInstructions()},1E3);window.addEventListener("hashchange",App.hashChangeEvent,!1);setInterval(App.checkConnection,
App.checkConnectionInterval);setInterval(App.checkDealsTimer,1E3);App.initialized=!0},null,function(){App.showNoConnection()});return 0},changeOrientation:function(){window.scrollTo(0,0);T.byId("splash").style.display="block";setTimeout(function(){location.reload()},300)}};window.addEventListener("load",function(){setTimeout(T.preloadImages,0);App.init();window.scrollTo(0,0);window.Sailthru&&Sailthru.setup({domain:"horizon.letsdeal.se"})});
window.addEventListener("orientationchange",function(){App.changeOrientation()},!1);document.addEventListener("touchmove",function(a){T.isIOS&&a.changedTouches.length&&(a.changedTouches[0].screenY<T.p(Styles.topMenu.height)||a.changedTouches[0].screenY>T.h()-T.p(Styles.footer.height))&&a.preventDefault()},!1);
